#!/bin/bash

function dat {
	echo $(date +'%a %b %d %H:%M')
}

function mem {
	echo "$(free -h | head -n2 | tail -n1 | awk '{print $3 "/" $2}')"
}

function bat {
	first=true
	acpi | while read line ; do
	   [ "$first" = "false" ] && echo -n ", "
	   [ "$first" = "true" ] && first=false
	   echo -n "BAT$(echo $line | cut -d, -f 1-2 | cut -d' ' -f2- | sed s/Discharging,/dis/ | sed s/Charging,/ch/ | sed s/Unknown,/unk/ | sed s/Full,/full/ | sed s/Not\ charging,/no/)"
	done
	[ -z "$(acpi)" ] && echo ?
}

function temp {
	first=true
	acpi -t | while read line ; do
	   [ "$first" = "false" ] && echo -n ", "
	   [ "$first" = "true" ] && first=false
	   echo -n "$(echo $line | awk '{print "TH"$2, $4}')"
	done
	[ -z "$(acpi -t)" ] && echo ?
}

echo "$(dat)  $(bat)  $(mem)  $(temp)"

